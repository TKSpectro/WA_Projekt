<div class="wrapper">
    <div class="left-side">
        <div class="scroll-wrapper">
            <ul class="menu-list">
                <li>PR</li>
                <li><img src="../../assets/images/gear.svg" alt=""></li>
                <li id="btn-chat-all" data-id="0" data-new="0" data-shortname="All" onclick="userPressed(this); return false;"><img src="../../assets/images/chat.svg" alt="ALl"></li>
                <% for(let index = 0; index < users.length; ++index) { %>
                    <%
                    //exclude the current user
                    if(self.req.user.id === users[index].id){
                        continue;
                    } %>
                        <li id="btn-chat-<%=users[index].id%>" data-id="<%=users[index].id%>" data-shortname="<%=users[index].shortName()%>" data-fullname="<%=users[index].fullname()%>" data-new="0" onclick="userPressed(this); return false;">
                            <%=users[index].shortName()%>
                        </li>
                        <% } //endfor %>
            </ul>
        </div>
    </div>
    <div class="chat-wrapper">
        <div class="topbar">
            <div class="title" id="chatTitle">
                Chat
            </div>
            <div class="close" onclick="chatClose();">
                X
            </div>
        </div>
        <div class="chat">
            <div class="messages-wrapper">
                <div class="scroll-wrapper" id="messages" data-action="<%-self.urlFor('api/messages', 'index')%>"></div>
            </div>
            <div class="input-wrapper">
                <textarea id="message" placeholder="Schreiben Sie irgendwas...."></textarea>
                <button id="send-message" onclick="sendPressed(this); return false;"><img
                        src="../../assets/images/paper-plane.svg"></button>
            </div>
        </div>
    </div>
    <div class="right-side">
        <div class="kanban-wrapper">
            <div class="row">
                <% for (let index = 0; index < workflows.length; index++) { %>
                    <% const workflow = workflows[index]; %>
                        <div class="col">
                            <div class="title" style="background: <%-workflow.color%>;border-left-color: <%-workflow.color%>;">
                                <span class="workflow"><%=workflow.name%></span> <span class="add">+</span>
                            </div>

                        </div>
                        <%} //ENDFOR %>
            </div>

            <!-- <div class="row">
                <% for (let index = 0; index < workflows.length; index++) { %>
                    <% const workflow = workflows[index]; %>
                        <div class="col">
                            <div class="add">
                                +
                            </div>
                        </div>
                        <%} //ENDFOR %>
            </div>-->

            <div class="row tasks-wrapper">
                <% for (let index = 0; index < workflows.length; index++) { %>
                    <% const workflow = workflows[index]; %>
                        <div class="col">
                            <div class="tasks" data-workflow-id="<%-workflow.id%>" data-workflow-color="<%-workflow.color%>">
                                <% if(workflowTasks[workflow.id] instanceof Array) { %>
                                    <% for (let i = 0; i < workflowTasks[workflow.id].length; i++) { %>
                                        <% const task = workflowTasks[workflow.id][i]; %>
                                            <div class="task" style="border-color: <%-workflow.color%>;" data-id="<%-task.id%>">

                                                <div class="name">
                                                    #
                                                    <%-task.id%>
                                                        <%=task.name%>
                                                </div>
                                                <div class="time">
                                                    <!--This will only be shown in the task editor-->
                                                </div>

                                                <div class="footer">
                                                    <div class="assigned">
                                                        <%=task.assignedTo.fullname()%>
                                                    </div>
                                                    <div class="deadline">
                                                        <%-task.deadline.getDay()%>.
                                                            <%-task.deadline.getMonth() + 1%>.
                                                                <%-task.deadline.getFullYear()%>
                                                                    <%-task.deadline.getHours()%>:
                                                                        <%-task.deadline.getMinutes()%>
                                                    </div>
                                                </div>
                                            </div>
                                            <% } //ENDFOR %>
                                                <% } //ENDIF %>
                            </div>
                        </div>
                        <%} //ENDFOR %>
            </div>
        </div>
    </div>
</div>
<div class="taskForm">
    <form id="taskForm" action="<%-self.urlFor('api/tasks', 'create', null, 'POST')%>" method="POST" data="<%=self.req.user.id%>">
        <div><label for="name">name:</label><br>
            <input type="text" id="nameTask" name="name"></div>

        <div> <label for="text">Text:</label><br>
            <input type="text" id="textTask" name="text"></div>

        <input type="text" style="display:none;" id="currentUserId" value="<%-self.req.user.id%>">

        <div><label for="maximumWorkedTime">Maximum Work Time</label><br>
            <input type="number" id="maxTime" name="maxTime"></div>

        <div><label for="deadline">Deadline:</label><br>
            <input type="date" id="deadline" name="deadline"></div>


        <div><label for="assignedToId">Assigned To:</label><br>
            <select class="select" id="assignedToId" name="assignedToId">
                    <% for(let index = 0; index < users.length; ++index) { %>
                <option value="<%=users[index].id%>"><%=users[index].fullname()%></option>
                <% } //endfor %>    
            </select>
        </div>

        <div><label for="projects">Projects:</label><br>
            <select class="select" id="projectID" name="projects">
                    <% for(let index = 0; index < projects.length; ++index) { %>
                <option value="<%=projects[index].id%>"><%=projects[index].name%></option>
                <% } //endfor %>    
            </select>
        </div>


        <div><label for="workflows">Workflow:</label><br>
            <select class="select" name="workflows" id="workflowId">
                    <% for(let index = 0; index < workflows.length; ++index) { %>
                <option value="<%=workflows[index].id%>"><%=workflows[index].name%></option>
                <% } //endfor %>    
            </select><br>
        </div>

        <button onclick="addPressed(this); return false;">Add Task</button>
    </form>
</div>